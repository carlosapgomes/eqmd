{% comment %}
Base event card template - provides common structure for all event types
Parameters expected:
- event: The event object
- event_data: Object containing event, can_edit, can_delete, excerpt
{% endcomment %}

<article class="timeline-card card card-medical mb-3" 
         role="article"
         aria-labelledby="event-{{ event.pk }}-title"
         aria-describedby="event-{{ event.pk }}-content">
    
    <div class="card-body">
        <!-- Event Header -->
        <header class="d-flex align-items-start justify-content-between mb-2">
            <div class="d-flex align-items-center">
                <h3 id="event-{{ event.pk }}-title" class="h6 mb-0 me-2">
                    <span class="badge {{ event.get_event_type_badge_class }} event-type-badge"
                          data-bs-toggle="tooltip" 
                          data-bs-placement="top" 
                          title="{{ event.get_event_type_display }}">
                        <i class="{{ event.get_event_type_icon }} me-1" aria-hidden="true"></i>
                        {{ event.get_event_type_short_display }}
                    </span>
                </h3>
                <time datetime="{{ event.created_at|date:'c' }}" 
                      class="text-muted small">
                    <i class="bi bi-clock me-1" aria-hidden="true"></i>
                    {{ event.created_at|date:"d/m/Y H:i" }}
                </time>
            </div>
            
            <!-- Event Actions - This block can be overridden by specific event types -->
            <div class="event-actions" role="group" 
                 aria-label="Ações para {{ event.get_event_type_display }}">
                {% block event_actions %}
                <div class="btn-group btn-group-sm">
                    <a href="{{ event.get_absolute_url }}" 
                       class="btn btn-outline-primary btn-sm"
                       aria-label="Visualizar {{ event.get_event_type_display }} completo"
                       data-bs-toggle="tooltip" 
                       data-bs-placement="top" 
                       title="Ver detalhes">
                        <i class="bi bi-eye" aria-hidden="true"></i>
                        <span class="visually-hidden">Visualizar</span>
                    </a>
                    {% if event_data.can_edit %}
                        <a href="{{ event.get_edit_url }}" 
                           class="btn btn-outline-warning btn-sm"
                           aria-label="Editar {{ event.get_event_type_display }}"
                           data-bs-toggle="tooltip" 
                           data-bs-placement="top" 
                           title="Editar">
                            <i class="bi bi-pencil" aria-hidden="true"></i>
                            <span class="visually-hidden">Editar</span>
                        </a>
                    {% endif %}
                </div>
                {% endblock event_actions %}
            </div>
        </header>

        <!-- Event Content -->
        <div id="event-{{ event.pk }}-content" class="event-content">
            {% block event_content %}
            <p class="event-excerpt">{{ event_data.excerpt }}</p>
            {% endblock event_content %}
        </div>

        <!-- Event Metadata -->
        <footer class="d-flex align-items-center justify-content-between mt-2 pt-2 border-top">
            {% block event_metadata %}
            <small class="text-muted">
                <i class="bi bi-person me-1" aria-hidden="true"></i>
                <span aria-label="Criado por">{{ event.created_by.get_full_name }}</span>
                {% if event.created_by.profession %}
                    <span aria-label="Profissão">({{ event.created_by.profession }})</span>
                {% endif %}
            </small>
            {% if event.updated_at != event.created_at %}
                <small class="text-muted">
                    <i class="bi bi-pencil-square me-1" aria-hidden="true"></i>
                    <time datetime="{{ event.updated_at|date:'c' }}">
                        Editado em {{ event.updated_at|date:"d/m/Y H:i" }}
                    </time>
                </small>
            {% endif %}
            {% endblock event_metadata %}
        </footer>
    </div>
</article>