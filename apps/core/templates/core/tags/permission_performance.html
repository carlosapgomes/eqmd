{% comment %}
Permission Performance Widget Template

This template displays permission system performance information
including cache statistics and permission summary.
{% endcomment %}

{% if user %}
<div class="card border-info">
    <div class="card-header bg-info text-white">
        <h6 class="card-title mb-0">
            <i class="bi bi-speedometer2"></i>
            Permission Performance
        </h6>
    </div>
    <div class="card-body">
        {% if error %}
            <div class="alert alert-warning mb-0">
                <i class="bi bi-exclamation-triangle"></i>
                {{ error }}
            </div>
        {% else %}
            {% if summary %}
                <div class="row">
                    <div class="col-md-6">
                        <h6>Permission Summary</h6>
                        <ul class="list-unstyled">
                            <li><strong>Total Permissions:</strong> {{ summary.permission_counts.total_permissions }}</li>
                            <li><strong>Group Permissions:</strong> {{ summary.permission_counts.group_permissions }}</li>
                            <li><strong>User Permissions:</strong> {{ summary.permission_counts.user_permissions }}</li>
                            <li><strong>Groups:</strong> {{ summary.permission_counts.groups_count }}</li>
                        </ul>
                        
                        {% if summary.accessible_models %}
                            <h6>Accessible Models</h6>
                            <div class="d-flex flex-wrap gap-1">
                                {% for model in summary.accessible_models %}
                                    <span class="badge bg-primary">{{ model|title }}</span>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-6">
                        {% if caching_enabled and cache_stats %}
                            <h6>Cache Performance</h6>
                            <ul class="list-unstyled">
                                <li><strong>Cache Hits:</strong> {{ cache_stats.hits }}</li>
                                <li><strong>Cache Misses:</strong> {{ cache_stats.misses }}</li>
                                <li><strong>Total Requests:</strong> {{ cache_stats.total_requests }}</li>
                                <li><strong>Hit Ratio:</strong> {{ cache_stats.hit_ratio|floatformat:2 }}%</li>
                            </ul>
                            
                            {% if cache_stats.hit_ratio > 0.7 %}
                                <div class="alert alert-success py-2">
                                    <i class="bi bi-check-circle"></i>
                                    Good cache performance
                                </div>
                            {% elif cache_stats.hit_ratio > 0.4 %}
                                <div class="alert alert-warning py-2">
                                    <i class="bi bi-exclamation-triangle"></i>
                                    Moderate cache performance
                                </div>
                            {% else %}
                                <div class="alert alert-danger py-2">
                                    <i class="bi bi-x-circle"></i>
                                    Poor cache performance
                                </div>
                            {% endif %}
                        {% else %}
                            <div class="alert alert-info py-2">
                                <i class="bi bi-info-circle"></i>
                                Caching is disabled
                            </div>
                        {% endif %}
                    </div>
                </div>
            {% endif %}
        {% endif %}
    </div>
</div>
{% else %}
<div class="alert alert-warning">
    <i class="bi bi-person-x"></i>
    User not authenticated
</div>
{% endif %}
