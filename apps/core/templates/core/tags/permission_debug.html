{% if user %}
<div class="card mt-3">
    <div class="card-header">
        <h6 class="card-title mb-0">
            <i class="bi bi-shield-check me-2"></i>
            Permission Debug - {{ user.username }}
        </h6>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <h6>User Information</h6>
                <ul class="list-unstyled">
                    <li><strong>Username:</strong> {{ user.username }}</li>
                    <li><strong>Email:</strong> {{ user.email }}</li>
                    <li><strong>Profession:</strong> {{ profession_display }}</li>
                    <li><strong>Staff:</strong> 
                        {% if user.is_staff %}
                            <span class="badge bg-success">Yes</span>
                        {% else %}
                            <span class="badge bg-secondary">No</span>
                        {% endif %}
                    </li>
                    <li><strong>Superuser:</strong> 
                        {% if user.is_superuser %}
                            <span class="badge bg-danger">Yes</span>
                        {% else %}
                            <span class="badge bg-secondary">No</span>
                        {% endif %}
                    </li>
                </ul>

                <h6>Hospital Context</h6>
                <ul class="list-unstyled">
                    <li><strong>Has Context:</strong> 
                        {% if has_hospital_context %}
                            <span class="badge bg-success">Yes</span>
                        {% else %}
                            <span class="badge bg-warning">No</span>
                        {% endif %}
                    </li>
                    <li><strong>Current Hospital:</strong> 
                        {% if current_hospital %}
                            {{ current_hospital.name }}
                        {% else %}
                            <em>None selected</em>
                        {% endif %}
                    </li>
                </ul>
            </div>
            
            <div class="col-md-6">
                <h6>Groups ({{ groups.count }})</h6>
                {% if groups %}
                    <ul class="list-unstyled">
                        {% for group in groups %}
                            <li>
                                <span class="badge bg-primary">{{ group.name }}</span>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p class="text-muted">No groups assigned</p>
                {% endif %}
            </div>
        </div>
        
        <div class="row mt-3">
            <div class="col-12">
                <h6>Permissions ({{ permissions|length }})</h6>
                {% if permissions %}
                    <div class="row">
                        {% for permission in permissions %}
                            <div class="col-md-4 col-sm-6">
                                <small class="text-muted">{{ permission }}</small>
                            </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <p class="text-muted">No permissions assigned</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% else %}
<div class="alert alert-warning">
    <i class="bi bi-exclamation-triangle me-2"></i>
    User not authenticated
</div>
{% endif %}
