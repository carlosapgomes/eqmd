{% extends "base_app.html" %}
{% load static %}

{% block extra_head %}
{{ block.super }}
<!-- MediaFiles specific CSS -->
<link rel="stylesheet" href="{% static 'mediafiles/css/mediafiles.css' %}">
<style>
    /* Media-specific styling */
    .media-thumbnail {
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    
    .media-thumbnail:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }
    
    .media-upload-area {
        border: 2px dashed #dee2e6;
        border-radius: 8px;
        padding: 2rem;
        text-align: center;
        transition: border-color 0.3s ease, background-color 0.3s ease;
        background-color: #f8f9fa;
    }
    
    .media-upload-area:hover {
        border-color: #2c5aa0;
        background-color: #f0f4f8;
    }
    
    .media-upload-area.dragover {
        border-color: #20c997;
        background-color: #e8f5f0;
    }
    
    .media-preview {
        max-width: 100%;
        max-height: 300px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .media-metadata {
        background-color: #f8f9fa;
        border-radius: 6px;
        padding: 1rem;
        margin-top: 1rem;
    }
    
    .media-metadata .metadata-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.25rem 0;
        border-bottom: 1px solid #e9ecef;
    }
    
    .media-metadata .metadata-item:last-child {
        border-bottom: none;
    }
    
    .media-metadata .metadata-label {
        font-weight: 500;
        color: #495057;
    }
    
    .media-metadata .metadata-value {
        color: #6c757d;
        font-family: monospace;
        font-size: 0.9em;
    }
    
    .media-progress {
        height: 6px;
        border-radius: 3px;
        overflow: hidden;
        background-color: #e9ecef;
        margin-top: 1rem;
    }
    
    .media-progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #2c5aa0, #20c997);
        transition: width 0.3s ease;
    }
    
    .media-error {
        color: #dc3545;
        background-color: #f8d7da;
        border: 1px solid #f5c6cb;
        border-radius: 6px;
        padding: 0.75rem;
        margin-top: 1rem;
    }
    
    .media-success {
        color: #155724;
        background-color: #d4edda;
        border: 1px solid #c3e6cb;
        border-radius: 6px;
        padding: 0.75rem;
        margin-top: 1rem;
    }
    
    /* Breadcrumb styling */
    .media-breadcrumb {
        background-color: transparent;
        padding: 0;
        margin-bottom: 1.5rem;
    }
    
    .media-breadcrumb .breadcrumb-item {
        color: #6c757d;
    }
    
    .media-breadcrumb .breadcrumb-item.active {
        color: #2c5aa0;
        font-weight: 500;
    }
    
    .media-breadcrumb .breadcrumb-item + .breadcrumb-item::before {
        content: "›";
        color: #adb5bd;
    }
    
    /* Action buttons */
    .media-actions {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
        margin-top: 1rem;
    }
    
    .media-actions .btn {
        border-radius: 6px;
        font-weight: 500;
        padding: 0.5rem 1rem;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
        .media-upload-area {
            padding: 1.5rem 1rem;
        }
        
        .media-actions {
            justify-content: center;
        }
        
        .media-actions .btn {
            flex: 1;
            min-width: 120px;
        }
    }
</style>
{% endblock extra_head %}

{% block app_content %}
<div class="container-fluid">
    <!-- Breadcrumb Navigation -->
    {% block media_breadcrumb %}
    <nav aria-label="breadcrumb" class="media-breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                <a href="{% url 'apps.core:dashboard' %}" class="text-decoration-none">
                    <i class="bi bi-house-door me-1"></i>
                    Dashboard
                </a>
            </li>
            {% if patient %}
            <li class="breadcrumb-item">
                <a href="{% url 'apps.patients:patient_detail' patient.id %}" class="text-decoration-none">
                    <i class="bi bi-person me-1"></i>
                    {{ patient.name }}
                </a>
            </li>
            {% endif %}
            {% block breadcrumb_items %}
            <li class="breadcrumb-item active" aria-current="page">
                <i class="bi bi-camera me-1"></i>
                Mídia
            </li>
            {% endblock breadcrumb_items %}
        </ol>
    </nav>
    {% endblock media_breadcrumb %}

    <!-- Messages -->
    {% if messages %}
    <div class="messages mb-4">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
            <i class="bi bi-{% if message.tags == 'success' %}check-circle{% elif message.tags == 'error' or message.tags == 'danger' %}exclamation-triangle{% elif message.tags == 'warning' %}exclamation-circle{% else %}info-circle{% endif %} me-2"></i>
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- Main Content -->
    {% block media_content %}
    <!-- Specific media content will be injected here -->
    {% endblock media_content %}
</div>
{% endblock app_content %}

{% block extra_scripts %}
{{ block.super }}
<!-- MediaFiles specific JavaScript -->
<script src="{% static 'mediafiles/js/mediafiles.js' %}"></script>
<script>
    // Initialize media-specific functionality
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize tooltips for media elements
        const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
        const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl));
        
        // Initialize any media-specific components
        if (typeof MediaFiles !== 'undefined') {
            MediaFiles.init();
        }
    });
</script>
{% endblock extra_scripts %}
