const CACHE_NAME="eqmd-static-v1",STATIC_ASSETS=["/","/static/css/main.css","/static/js/bootstrap.min.js","/static/js/popper.min.js","/static/css/bootstrap-icons.min.css","/static/images/logo.png","/static/manifest.json"];self.addEventListener("install",(e=>{e.waitUntil(caches.open(CACHE_NAME).then((e=>(console.log("PWA: Caching static assets"),e.addAll(STATIC_ASSETS)))).catch((e=>{console.log("PWA: Cache install failed:",e)}))),self.skipWaiting()})),self.addEventListener("activate",(e=>{e.waitUntil(caches.keys().then((e=>Promise.all(e.map((e=>{if(e!==CACHE_NAME)return console.log("PWA: Deleting old cache:",e),caches.delete(e)})))))),self.clients.claim()})),self.addEventListener("fetch",(e=>{const t=new URL(e.request.url);if(t.pathname.includes("/api/")||t.pathname.includes("/patients/")||t.pathname.includes("/events/")||t.pathname.includes("/dailynotes/")||t.pathname.includes("/mediafiles/")||t.pathname.includes("/admin/")||"GET"!==e.request.method)return fetch(e.request);e.respondWith(caches.match(e.request).then((s=>s||fetch(e.request).then((s=>{if(200===s.status&&(t.pathname.startsWith("/static/")||"/"===t.pathname||t.pathname.includes(".css")||t.pathname.includes(".js")||t.pathname.includes(".png")||t.pathname.includes(".jpg")||t.pathname.includes(".ico"))){const t=s.clone();caches.open(CACHE_NAME).then((s=>{s.put(e.request,t)}))}return s})))).catch((()=>{if("document"===e.request.destination)return caches.match("/")})))})),self.addEventListener("message",(e=>{e.data&&"SKIP_WAITING"===e.data.type&&self.skipWaiting()}));