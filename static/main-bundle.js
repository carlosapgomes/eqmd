(()=>{"use strict";function e(e,n,o=null){const a=e.querySelector("i"),i=a.className;n?(a.className="bi bi-check me-1",e.classList.remove("btn-outline-secondary"),e.classList.add("btn-success"),t("Conteúdo copiado para a área de transferência!","success")):(a.className="bi bi-x me-1",e.classList.remove("btn-outline-secondary"),e.classList.add("btn-danger"),t(o||"Erro ao copiar conteúdo","danger")),setTimeout((()=>{a.className=i,e.classList.remove("btn-success","btn-danger"),e.classList.add("btn-outline-secondary")}),2e3)}function t(e,t="info"){let n=document.querySelector(".toast-container");n||(n=document.createElement("div"),n.className="toast-container position-fixed top-0 end-0 p-3",n.style.zIndex="1055",document.body.appendChild(n));const o="toast-"+Date.now(),a=document.createElement("div");a.id=o,a.className=`toast align-items-center text-bg-${t} border-0`,a.role="alert",a.ariaLive="assertive",a.ariaAtomic="true",a.innerHTML=`\n        <div class="d-flex">\n            <div class="toast-body">\n                ${e}\n            </div>\n            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>\n        </div>\n    `,n.appendChild(a),void 0!==window.bootstrap&&window.bootstrap.Toast?(new window.bootstrap.Toast(a,{autohide:!0,delay:3e3}).show(),a.addEventListener("hidden.bs.toast",(function(){a.remove()}))):setTimeout((()=>{a.parentNode&&a.remove()}),3e3)}document.addEventListener("DOMContentLoaded",(function(){document.addEventListener("click",(function(t){const n=t.target.closest(".copy-content-btn");n&&(t.preventDefault(),async function(t){const n=t.dataset.content;if(n)try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(n),e(t,!0);else{const o=document.createElement("textarea");o.value=n,o.style.position="fixed",o.style.opacity="0",o.style.pointerEvents="none",document.body.appendChild(o),o.select();const a=document.execCommand("copy");if(document.body.removeChild(o),!a)throw new Error("Copy command failed");e(t,!0)}}catch(n){console.error("Failed to copy text:",n),e(t,!1,"Falha ao copiar conteúdo")}else e(t,!1,"Nenhum conteúdo para copiar")}(n))}))}))})(),document.addEventListener("DOMContentLoaded",(function(){document.getElementById("eventModal")&&(new bootstrap.Modal(document.getElementById("eventModal")),document.addEventListener("click",(function(e){const t=e.target.closest("[data-event-modal]");t&&(e.preventDefault(),function(e){const t=bootstrap.Modal.getInstance(document.getElementById("eventModal")),n=document.getElementById("eventModal");n.querySelector("#modal-loading").style.display="block",n.querySelector("#modal-content").style.display="none",n.querySelector("#modal-view-full").style.display="none",n.querySelector("#modal-edit").style.display="none",t.show(),fetch(`/events/${e}/api/`).then((e=>{if(!e.ok)throw new Error("Event not found");return e.json()})).then((e=>{!function(e){const t=document.getElementById("eventModal");if(t.querySelector("#modal-loading").style.display="none",t.querySelector("#modal-content").style.display="block",t.querySelector("#modal-event-type").textContent=e.event_type_display,t.querySelector("#modal-datetime").textContent=e.created_at_formatted,t.querySelector("#modal-creator").textContent=e.created_by_name,t.querySelector("#modal-event-content").innerHTML=e.content||e.description||"Sem conteúdo",e.updated_at!==e.created_at){const n=t.querySelector("#modal-updated");n.style.display="block",n.querySelector("span").textContent=`Última edição: ${e.updated_at_formatted}`}const n=t.querySelector("#modal-view-full"),o=t.querySelector("#modal-edit");n.href=e.detail_url,n.style.display="inline-block",e.can_edit&&(o.href=e.edit_url,o.style.display="inline-block")}(e)})).catch((e=>{console.error("Error loading event:",e),function(){const e=document.getElementById("eventModal");e.querySelector("#modal-loading").style.display="none",e.querySelector("#modal-content").innerHTML='\n        <div class="alert alert-danger">\n            <i class="bi bi-exclamation-triangle me-2"></i>\n            Erro ao carregar evento\n        </div>\n    ',e.querySelector("#modal-content").style.display="block"}()}))}(t.dataset.eventModal))}))),function(){const e=document.getElementById("timeline-filters");e&&(e.querySelectorAll('input[type="checkbox"], input[type="radio"], select').forEach((t=>{t.addEventListener("change",(function(){!function(){const e=document.querySelector(".timeline-events");if(e&&(e.style.opacity="0.6",e.style.pointerEvents="none",!document.querySelector(".filter-loading"))){const t=document.createElement("div");t.className="filter-loading position-absolute top-50 start-50 translate-middle",t.innerHTML='\n                <div class="spinner-border text-primary" role="status">\n                    <span class="visually-hidden">Carregando...</span>\n                </div>\n            ',e.parentElement.style.position="relative",e.parentElement.appendChild(t)}}(),setTimeout((()=>{e.submit()}),300)}))})),e.querySelectorAll('input[type="date"]').forEach((t=>{t.addEventListener("change",(function(){e.querySelectorAll('input[name="quick_date"]').forEach((e=>{""!==e.value&&(e.checked=!1)}))}))})),e.querySelectorAll('input[name="quick_date"]').forEach((t=>{t.addEventListener("change",(function(){""!==this.value&&e.querySelectorAll('input[type="date"]').forEach((e=>{e.value=""}))}))})))}(),function(){const e=document.querySelector("[data-next-page]")?.dataset.nextPage;if(!e)return;const t={root:null,rootMargin:"100px",threshold:.1},n=document.createElement("div");n.className="load-more-trigger",n.style.height="1px";const o=document.querySelector(".timeline-events");if(o){o.appendChild(n);const a=new IntersectionObserver((t=>{t.forEach((t=>{var n;t.isIntersecting&&(n=e,console.log("Loading more events from:",n),a.unobserve(t.target))}))}),t);a.observe(n)}}()})),(()=>{function e(e){const t=document.getElementById("filter-live-region");t&&(t.textContent=e,setTimeout((()=>{t.textContent=""}),1e3))}document.addEventListener("DOMContentLoaded",(function(){!function(){const t=document.querySelectorAll(".timeline-card");let n=-1;function o(o){if(o<0||o>=t.length)return;n=o;const a=t[o];t.forEach((e=>e.classList.remove("keyboard-focused"))),a.classList.add("keyboard-focused"),a.scrollIntoView({behavior:"smooth",block:"center"});const i=a.querySelector(".event-type-badge").textContent.trim(),r=a.querySelector("time").textContent.trim();e(`Evento ${o+1} de ${t.length}: ${i}, ${r}`)}document.addEventListener("keydown",(function(e){if(e.target.closest(".timeline-events"))switch(e.key){case"ArrowDown":e.preventDefault(),o(n+1);break;case"ArrowUp":e.preventDefault(),o(n-1);break;case"Home":e.preventDefault(),o(0);break;case"End":e.preventDefault(),o(t.length-1);break;case"Enter":case" ":if(n>=0){e.preventDefault();const o=t[n].querySelector(".btn-outline-primary");o&&o.click()}}}))}(),document.getElementById("filter-live-region")||function(){const e=document.createElement("div");e.id="filter-live-region",e.setAttribute("aria-live","polite"),e.setAttribute("aria-atomic","true"),e.className="visually-hidden",document.body.appendChild(e)}(),document.querySelectorAll("#timeline-filters input, #timeline-filters select").forEach((t=>{t.addEventListener("change",(function(){const t=this.name,n="checkbox"===this.type?this.checked?this.nextElementSibling.textContent:"removido":this.value||"todos";setTimeout((()=>{e(`Filtro ${t}: ${n}`)}),100)}))})),function(){const e=document.querySelector(".visually-hidden-focusable");e&&e.addEventListener("click",(function(e){e.preventDefault();const t=document.querySelector(this.getAttribute("href"));t&&(t.focus(),t.scrollIntoView({behavior:"smooth"}))}));const t=document.getElementById("eventModal");t&&(t.addEventListener("shown.bs.modal",(function(){const e=this.querySelector("button, input, select, textarea, a[href]");e&&e.focus()})),t.addEventListener("hidden.bs.modal",(function(){const e=document.querySelector("[data-event-modal]:focus-within");e&&e.focus()})))}()}));const t=document.createElement("style");t.textContent="\n    .keyboard-focused {\n        outline: 3px solid #0d6efd;\n        outline-offset: 2px;\n        z-index: 10;\n        position: relative;\n    }\n    \n    .timeline-card:focus-within {\n        outline: 2px solid #0d6efd;\n        outline-offset: 1px;\n    }\n    \n    .visually-hidden-focusable:focus {\n        position: static !important;\n        width: auto !important;\n        height: auto !important;\n        clip: auto !important;\n        white-space: normal !important;\n        background-color: #007bff;\n        color: white;\n        padding: 0.5rem;\n        text-decoration: none;\n        border-radius: 0.25rem;\n    }\n",document.head.appendChild(t)})(),function(){"use strict";const e=document.getElementById("pageLoadingOverlay");function t(){e.classList.remove("d-none")}function n(){e.classList.add("d-none")}function o(e){if(e.hostname&&e.hostname!==window.location.hostname)return!1;if(e.getAttribute("href")?.startsWith("#"))return!1;if(e.getAttribute("href")?.startsWith("javascript:"))return!1;if("mailto:"===e.protocol||"tel:"===e.protocol)return!1;if("_blank"===e.target||"_new"===e.target)return!1;if(e.hasAttribute("data-bs-toggle"))return!1;if(e.hasAttribute("download"))return!1;const t=["no-loading","copy-content-btn","dropdown-toggle"];for(const n of t)if(e.classList.contains(n))return!1;return!e.classList.contains("nav-link")||!e.hasAttribute("data-bs-toggle")&&!e.closest(".dropdown")}function a(e){if(e.hasAttribute("data-no-loading")||e.classList.contains("no-loading"))return!1;if(e.hasAttribute("data-ajax")||e.classList.contains("ajax-form"))return!1;const t=e.method?.toLowerCase()||"get",n=e.action;return!!("get"!==t||n&&n!==window.location.href&&n!==window.location.pathname)}function i(){let e;function i(){clearTimeout(e),e=setTimeout(n,15e3)}document.addEventListener("click",(function(e){const n=e.target.closest("a");n&&o(n)&&setTimeout(t,100)})),document.addEventListener("submit",(function(e){a(e.target)&&t()})),window.addEventListener("beforeunload",(function(){})),window.addEventListener("pageshow",(function(e){n()})),window.addEventListener("load",(function(){n()})),document.addEventListener("click",(function(e){const t=e.target.closest("a");t&&o(t)&&i()})),document.addEventListener("submit",(function(e){a(e.target)&&i()}))}e?"loading"===document.readyState?document.addEventListener("DOMContentLoaded",i):i():console.warn("Page loading overlay element not found")}();