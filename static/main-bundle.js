(()=>{"use strict";function e(e,o,n=null){const i=e.querySelector("i"),a=i.className;o?(i.className="bi bi-check me-1",e.classList.remove("btn-outline-secondary"),e.classList.add("btn-success"),t("Conteúdo copiado para a área de transferência!","success")):(i.className="bi bi-x me-1",e.classList.remove("btn-outline-secondary"),e.classList.add("btn-danger"),t(n||"Erro ao copiar conteúdo","danger")),setTimeout((()=>{i.className=a,e.classList.remove("btn-success","btn-danger"),e.classList.add("btn-outline-secondary")}),2e3)}function t(e,t="info"){let o=document.querySelector(".toast-container");o||(o=document.createElement("div"),o.className="toast-container position-fixed top-0 end-0 p-3",o.style.zIndex="1055",document.body.appendChild(o));const n="toast-"+Date.now(),i=document.createElement("div");i.id=n,i.className=`toast align-items-center text-bg-${t} border-0`,i.role="alert",i.ariaLive="assertive",i.ariaAtomic="true",i.innerHTML=`\n        <div class="d-flex">\n            <div class="toast-body">\n                ${e}\n            </div>\n            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>\n        </div>\n    `,o.appendChild(i),void 0!==window.bootstrap&&window.bootstrap.Toast?(new window.bootstrap.Toast(i,{autohide:!0,delay:3e3}).show(),i.addEventListener("hidden.bs.toast",(function(){i.remove()}))):setTimeout((()=>{i.parentNode&&i.remove()}),3e3)}document.addEventListener("DOMContentLoaded",(function(){document.addEventListener("click",(function(t){const o=t.target.closest(".copy-content-btn");o&&(t.preventDefault(),async function(t){const o=t.dataset.content;if(o)try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(o),e(t,!0);else{const n=document.createElement("textarea");n.value=o,n.style.position="fixed",n.style.opacity="0",n.style.pointerEvents="none",document.body.appendChild(n),n.select();const i=document.execCommand("copy");if(document.body.removeChild(n),!i)throw new Error("Copy command failed");e(t,!0)}}catch(o){console.error("Failed to copy text:",o),e(t,!1,"Falha ao copiar conteúdo")}else e(t,!1,"Nenhum conteúdo para copiar")}(o))}))}))})(),window.MediaFiles=function(){"use strict";const e=5242880,t=52428800,o=["image/jpeg","image/png","image/webp"],n=["video/mp4","video/webm","video/quicktime"],i={formatFileSize:function(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},getFileExtension:function(e){return e.slice((e.lastIndexOf(".")-1>>>0)+2).toLowerCase()},validateFileType:function(e,t){return t.includes(e.type)},validateFileSize:function(e,t){return e.size<=t},showToast:function(e,t="info"){const o=document.createElement("div");o.className=`alert alert-${t} alert-dismissible fade show position-fixed`,o.style.cssText="top: 20px; right: 20px; z-index: 9999; min-width: 300px;",o.innerHTML=`\n                <i class="bi bi-${"success"===t?"check-circle":"error"===t?"exclamation-triangle":"info-circle"} me-2"></i>\n                ${e}\n                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>\n            `,document.body.appendChild(o),setTimeout((()=>{o.parentNode&&o.parentNode.removeChild(o)}),4e3)},debounce:function(e,t){let o;return function(...n){clearTimeout(o),o=setTimeout((()=>{clearTimeout(o),e(...n)}),t)}}},a={init:function(){this.setupDragAndDrop(),this.setupFileInputs()},setupDragAndDrop:function(){document.querySelectorAll(".media-upload-area").forEach((e=>{e.addEventListener("dragover",this.handleDragOver.bind(this)),e.addEventListener("dragleave",this.handleDragLeave.bind(this)),e.addEventListener("drop",this.handleDrop.bind(this))}))},setupFileInputs:function(){document.querySelectorAll('input[type="file"]').forEach((e=>{e.addEventListener("change",this.handleFileSelect.bind(this))}))},handleDragOver:function(e){e.preventDefault(),e.currentTarget.classList.add("dragover")},handleDragLeave:function(e){e.preventDefault(),e.currentTarget.classList.remove("dragover")},handleDrop:function(e){e.preventDefault(),e.currentTarget.classList.remove("dragover");const t=e.dataTransfer.files;if(t.length>0){const o=e.currentTarget.querySelector('input[type="file"]');o&&(o.files=t,this.handleFileSelect({target:o}))}},handleFileSelect:function(e){const t=e.target.files[0];t&&this.validateFile(t)&&this.showPreview(t,e.target)},validateFile:function(a){const s=i.validateFileType(a,o),l=i.validateFileType(a,n);if(!s&&!l)return i.showToast("Tipo de arquivo não permitido.","error"),!1;const r=s?e:t;return!!i.validateFileSize(a,r)||(i.showToast(`Arquivo muito grande. Máximo: ${r/1048576}MB`,"error"),!1)},showPreview:function(e,t){const o=document.getElementById("imagePreview")||document.getElementById("videoPreview");if(!o)return;const n=new FileReader;n.onload=function(n){const i=o.querySelector("img, video");i&&(i.src=n.target.result),a.updateMetadata(e),o.style.display="block";const s=t.closest(".media-upload-area");s&&(s.style.display="none")},n.readAsDataURL(e)},updateMetadata:function(e){const t={fileName:document.getElementById("fileName"),fileSize:document.getElementById("fileSize"),fileType:document.getElementById("fileType")};t.fileName&&(t.fileName.textContent=e.name),t.fileSize&&(t.fileSize.textContent=i.formatFileSize(e.size)),t.fileType&&(t.fileType.textContent=e.type)}},s={init:function(){this.setupPhotoModal(),this.setupZoomControls(),this.setupKeyboardNavigation()},setupPhotoModal:function(){const e=document.getElementById("photoModal");e&&(e.addEventListener("show.bs.modal",this.handleModalShow.bind(this)),e.addEventListener("hidden.bs.modal",this.handleModalHidden.bind(this)))},setupZoomControls:function(){const e=document.getElementById("photoZoomIn"),t=document.getElementById("photoZoomOut"),o=document.getElementById("photoZoomReset"),n=document.getElementById("photoFullscreenToggle"),i=document.getElementById("photoModalImage");e&&e.addEventListener("click",(()=>this.zoomIn())),t&&t.addEventListener("click",(()=>this.zoomOut())),o&&o.addEventListener("click",(()=>this.resetZoom())),n&&n.addEventListener("click",(()=>this.toggleFullscreen())),i&&(i.addEventListener("click",(e=>this.handleImageClick(e))),i.addEventListener("mousedown",(e=>this.startPan(e))),i.addEventListener("mousemove",(e=>this.updatePan(e))),i.addEventListener("mouseup",(()=>this.endPan())),i.addEventListener("mouseleave",(()=>this.endPan())),i.addEventListener("touchstart",(e=>this.startPan(e))),i.addEventListener("touchmove",(e=>this.updatePan(e))),i.addEventListener("touchend",(()=>this.endPan())))},setupKeyboardNavigation:function(){const e=document.getElementById("photoModal");e&&e.addEventListener("keydown",(t=>{switch(t.key){case"Escape":bootstrap.Modal.getInstance(e).hide();break;case"+":case"=":this.zoomIn();break;case"-":this.zoomOut();break;case"0":this.resetZoom();break;case"f":case"F":t.preventDefault(),this.toggleFullscreen()}}))},handleModalShow:function(e){const t=e.relatedTarget;if(!t)return;this.resetModalState();const o={id:t.dataset.photoId,url:t.dataset.photoUrl,title:t.dataset.photoTitle||"Foto",filename:t.dataset.photoFilename||"-",size:t.dataset.photoSize||"-",dimensions:t.dataset.photoDimensions||"-",created:t.dataset.photoCreated||"-",author:t.dataset.photoAuthor||"-"};this.updateModalContent(o),this.loadPhotoImage(o.url)},handleModalHidden:function(){this.resetModalState()},resetModalState:function(){this.currentZoom=1,this.isFullscreen=!1,this.isPanning=!1,this.panX=0,this.panY=0;const e=document.getElementById("photoModal"),t=e?.querySelector(".modal-dialog"),o=document.getElementById("photoModalContainer"),n=document.getElementById("photoModalLoading"),i=document.getElementById("photoModalError"),a=document.getElementById("photoModalImage"),s=document.getElementById("photoFullscreenToggle"),l=s?.querySelector("i");if(o&&o.classList.add("d-none"),n&&n.classList.remove("d-none"),i&&i.classList.add("d-none"),a&&(a.style.transform="scale(1)",a.style.cursor="zoom-in",a.style.maxHeight="70vh",a.style.maxWidth="",a.style.objectFit=""),t&&(t.classList.remove("modal-fullscreen"),t.classList.add("modal-xl","modal-dialog-centered")),l&&(l.className="bi bi-arrows-fullscreen"),s){s.title="Tela cheia";const e=s.querySelector(".visually-hidden");e&&(e.textContent="Tela cheia")}},updateModalContent:function(e){const t={title:document.getElementById("photoModalTitle"),filename:document.getElementById("photoModalFilename"),dimensions:document.getElementById("photoModalDimensions"),size:document.getElementById("photoModalSize"),created:document.getElementById("photoModalCreated"),author:document.getElementById("photoModalAuthor"),downloadBtn:document.getElementById("photoDownloadBtn")};t.title&&(t.title.textContent=e.title),t.filename&&(t.filename.textContent=e.filename),t.dimensions&&(t.dimensions.textContent=e.dimensions),t.size&&(t.size.textContent=e.size),t.created&&(t.created.textContent=e.created),t.author&&(t.author.textContent=e.author),t.downloadBtn&&(t.downloadBtn.href=e.url+"?download=1",t.downloadBtn.download=e.filename)},loadPhotoImage:function(e){const t=new Image,o=document.getElementById("photoModalImage"),n=document.getElementById("photoModalLoading"),i=document.getElementById("photoModalContainer"),a=document.getElementById("photoModalError");t.onload=()=>{o&&(o.src=e,o.alt=document.getElementById("photoModalFilename")?.textContent||"Photo"),n&&n.classList.add("d-none"),i&&i.classList.remove("d-none")},t.onerror=()=>{n&&n.classList.add("d-none"),a&&a.classList.remove("d-none")},t.src=e},currentZoom:1,zoomStep:.25,maxZoom:3,minZoom:.5,isFullscreen:!1,isPanning:!1,panStartX:0,panStartY:0,panX:0,panY:0,zoomIn:function(){this.currentZoom<this.maxZoom&&(this.currentZoom+=this.zoomStep,this.updateImageZoom())},zoomOut:function(){this.currentZoom>this.minZoom&&(this.currentZoom-=this.zoomStep,this.updateImageZoom())},resetZoom:function(){this.currentZoom=1,this.panX=0,this.panY=0,this.updateImageZoom()},toggleZoom:function(){this.currentZoom<this.maxZoom?this.currentZoom+=this.zoomStep:this.currentZoom=1,this.updateImageZoom()},updateImageZoom:function(){const e=document.getElementById("photoModalImage");e&&(e.style.transform=`scale(${this.currentZoom}) translate(${this.panX}px, ${this.panY}px)`,this.isPanning?e.style.cursor="grabbing":this.currentZoom>1?e.style.cursor="grab":e.style.cursor=this.currentZoom>=this.maxZoom?"zoom-out":"zoom-in")},toggleFullscreen:function(){const e=document.getElementById("photoModal"),t=e?.querySelector(".modal-dialog"),o=document.getElementById("photoModalImage"),n=document.getElementById("photoFullscreenToggle"),i=n?.querySelector("i");e&&t&&(this.isFullscreen=!this.isFullscreen,this.isFullscreen?(t.classList.remove("modal-xl","modal-dialog-centered"),t.classList.add("modal-fullscreen"),o&&(o.style.maxHeight="100vh",o.style.maxWidth="100vw",o.style.objectFit="contain"),i&&(i.className="bi bi-fullscreen-exit"),n&&(n.title="Sair da tela cheia",n.querySelector(".visually-hidden").textContent="Sair da tela cheia")):(t.classList.remove("modal-fullscreen"),t.classList.add("modal-xl","modal-dialog-centered"),o&&(o.style.maxHeight="70vh",o.style.maxWidth="",o.style.objectFit=""),i&&(i.className="bi bi-arrows-fullscreen"),n&&(n.title="Tela cheia",n.querySelector(".visually-hidden").textContent="Tela cheia")))},handleImageClick:function(e){!this.isPanning&&Math.abs(this.panStartX-e.clientX)<5&&Math.abs(this.panStartY-e.clientY)<5&&this.toggleZoom()},startPan:function(e){if(this.currentZoom<=1)return;e.preventDefault(),this.isPanning=!0;const t="touchstart"===e.type?e.touches[0].clientX:e.clientX,o="touchstart"===e.type?e.touches[0].clientY:e.clientY;this.panStartX=t-this.panX,this.panStartY=o-this.panY,this.updateImageZoom()},updatePan:function(e){if(!this.isPanning)return;e.preventDefault();const t="touchmove"===e.type?e.touches[0].clientX:e.clientX,o="touchmove"===e.type?e.touches[0].clientY:e.clientY;this.panX=t-this.panStartX,this.panY=o-this.panStartY,this.updateImageZoom()},endPan:function(){this.isPanning=!1,this.updateImageZoom()}},l={init:function(){this.setupImageModals(),this.setupZoomFunctionality()},setupImageModals:function(){document.querySelectorAll('[data-bs-toggle="modal"][data-bs-target*="imageModal"]').forEach((e=>{e.addEventListener("click",this.handleImageModalOpen.bind(this))}))},setupZoomFunctionality:function(){document.querySelectorAll(".zoomable-image").forEach((e=>{e.addEventListener("click",this.toggleZoom.bind(this))}))},handleImageModalOpen:function(e){const t=e.currentTarget.dataset.imageSrc,o=document.querySelector(e.currentTarget.dataset.bsTarget);if(o&&t){const e=o.querySelector(".modal-body img");e&&(e.src=t)}},toggleZoom:function(e){e.currentTarget.classList.toggle("zoomed")}};return{init:function(){a.init(),l.init(),s.init(),[...document.querySelectorAll('[data-bs-toggle="tooltip"]')].map((e=>new bootstrap.Tooltip(e)))},utils:i,fileUpload:a,imageViewer:l,photoModal:s}}(),document.addEventListener("DOMContentLoaded",(function(){"undefined"!=typeof bootstrap&&MediaFiles.init()})),document.addEventListener("DOMContentLoaded",(function(){document.getElementById("eventModal")&&(new bootstrap.Modal(document.getElementById("eventModal")),document.addEventListener("click",(function(e){const t=e.target.closest("[data-event-modal]");t&&(e.preventDefault(),function(e){const t=bootstrap.Modal.getInstance(document.getElementById("eventModal")),o=document.getElementById("eventModal");o.querySelector("#modal-loading").style.display="block",o.querySelector("#modal-content").style.display="none",o.querySelector("#modal-view-full").style.display="none",o.querySelector("#modal-edit").style.display="none",t.show(),fetch(`/events/${e}/api/`).then((e=>{if(!e.ok)throw new Error("Event not found");return e.json()})).then((e=>{!function(e){const t=document.getElementById("eventModal");if(t.querySelector("#modal-loading").style.display="none",t.querySelector("#modal-content").style.display="block",t.querySelector("#modal-event-type").textContent=e.event_type_display,t.querySelector("#modal-datetime").textContent=e.created_at_formatted,t.querySelector("#modal-creator").textContent=e.created_by_name,t.querySelector("#modal-event-content").innerHTML=e.content||e.description||"Sem conteúdo",e.updated_at!==e.created_at){const o=t.querySelector("#modal-updated");o.style.display="block",o.querySelector("span").textContent=`Última edição: ${e.updated_at_formatted}`}const o=t.querySelector("#modal-view-full"),n=t.querySelector("#modal-edit");o.href=e.detail_url,o.style.display="inline-block",e.can_edit&&(n.href=e.edit_url,n.style.display="inline-block")}(e)})).catch((e=>{console.error("Error loading event:",e),function(){const e=document.getElementById("eventModal");e.querySelector("#modal-loading").style.display="none",e.querySelector("#modal-content").innerHTML='\n        <div class="alert alert-danger">\n            <i class="bi bi-exclamation-triangle me-2"></i>\n            Erro ao carregar evento\n        </div>\n    ',e.querySelector("#modal-content").style.display="block"}()}))}(t.dataset.eventModal))}))),function(){const e=document.getElementById("timeline-filters");e&&(e.querySelectorAll('input[type="checkbox"], input[type="radio"], select').forEach((t=>{t.addEventListener("change",(function(){!function(){const e=document.querySelector(".timeline-events");if(e&&(e.style.opacity="0.6",e.style.pointerEvents="none",!document.querySelector(".filter-loading"))){const t=document.createElement("div");t.className="filter-loading position-absolute top-50 start-50 translate-middle",t.innerHTML='\n                <div class="spinner-border text-primary" role="status">\n                    <span class="visually-hidden">Carregando...</span>\n                </div>\n            ',e.parentElement.style.position="relative",e.parentElement.appendChild(t)}}(),setTimeout((()=>{e.submit()}),300)}))})),e.querySelectorAll('input[type="date"]').forEach((t=>{t.addEventListener("change",(function(){e.querySelectorAll('input[name="quick_date"]').forEach((e=>{""!==e.value&&(e.checked=!1)}))}))})),e.querySelectorAll('input[name="quick_date"]').forEach((t=>{t.addEventListener("change",(function(){""!==this.value&&e.querySelectorAll('input[type="date"]').forEach((e=>{e.value=""}))}))})))}(),function(){const e=document.querySelector("[data-next-page]")?.dataset.nextPage;if(!e)return;const t={root:null,rootMargin:"100px",threshold:.1},o=document.createElement("div");o.className="load-more-trigger",o.style.height="1px";const n=document.querySelector(".timeline-events");if(n){n.appendChild(o);const i=new IntersectionObserver((t=>{t.forEach((t=>{var o;t.isIntersecting&&(o=e,console.log("Loading more events from:",o),i.unobserve(t.target))}))}),t);i.observe(o)}}()})),(()=>{function e(e){const t=document.getElementById("filter-live-region");t&&(t.textContent=e,setTimeout((()=>{t.textContent=""}),1e3))}document.addEventListener("DOMContentLoaded",(function(){!function(){const t=document.querySelectorAll(".timeline-card");let o=-1;function n(n){if(n<0||n>=t.length)return;o=n;const i=t[n];t.forEach((e=>e.classList.remove("keyboard-focused"))),i.classList.add("keyboard-focused"),i.scrollIntoView({behavior:"smooth",block:"center"});const a=i.querySelector(".event-type-badge").textContent.trim(),s=i.querySelector("time").textContent.trim();e(`Evento ${n+1} de ${t.length}: ${a}, ${s}`)}document.addEventListener("keydown",(function(e){if(e.target.closest(".timeline-events"))switch(e.key){case"ArrowDown":e.preventDefault(),n(o+1);break;case"ArrowUp":e.preventDefault(),n(o-1);break;case"Home":e.preventDefault(),n(0);break;case"End":e.preventDefault(),n(t.length-1);break;case"Enter":case" ":if(o>=0){e.preventDefault();const n=t[o].querySelector(".btn-outline-primary");n&&n.click()}}}))}(),document.getElementById("filter-live-region")||function(){const e=document.createElement("div");e.id="filter-live-region",e.setAttribute("aria-live","polite"),e.setAttribute("aria-atomic","true"),e.className="visually-hidden",document.body.appendChild(e)}(),document.querySelectorAll("#timeline-filters input, #timeline-filters select").forEach((t=>{t.addEventListener("change",(function(){const t=this.name,o="checkbox"===this.type?this.checked?this.nextElementSibling.textContent:"removido":this.value||"todos";setTimeout((()=>{e(`Filtro ${t}: ${o}`)}),100)}))})),function(){const e=document.querySelector(".visually-hidden-focusable");e&&e.addEventListener("click",(function(e){e.preventDefault();const t=document.querySelector(this.getAttribute("href"));t&&(t.focus(),t.scrollIntoView({behavior:"smooth"}))}));const t=document.getElementById("eventModal");t&&(t.addEventListener("shown.bs.modal",(function(){const e=this.querySelector("button, input, select, textarea, a[href]");e&&e.focus()})),t.addEventListener("hidden.bs.modal",(function(){const e=document.querySelector("[data-event-modal]:focus-within");e&&e.focus()})))}()}));const t=document.createElement("style");t.textContent="\n    .keyboard-focused {\n        outline: 3px solid #0d6efd;\n        outline-offset: 2px;\n        z-index: 10;\n        position: relative;\n    }\n    \n    .timeline-card:focus-within {\n        outline: 2px solid #0d6efd;\n        outline-offset: 1px;\n    }\n    \n    .visually-hidden-focusable:focus {\n        position: static !important;\n        width: auto !important;\n        height: auto !important;\n        clip: auto !important;\n        white-space: normal !important;\n        background-color: #007bff;\n        color: white;\n        padding: 0.5rem;\n        text-decoration: none;\n        border-radius: 0.25rem;\n    }\n",document.head.appendChild(t)})(),window.Photo=function(){"use strict";const e={maxImageSize:5242880,allowedImageTypes:["image/jpeg","image/png","image/webp"],allowedImageExtensions:[".jpg",".jpeg",".png",".webp"],maxImageWidth:4e3,maxImageHeight:4e3,thumbnailSize:150,previewMaxWidth:800,previewMaxHeight:600},t={formatFileSize:function(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},getFileExtension:function(e){return e.slice((e.lastIndexOf(".")-1>>>0)+2).toLowerCase()},showToast:function(e,t="info"){const o=document.createElement("div");o.className=`alert alert-${t} alert-dismissible fade show position-fixed`,o.style.cssText="top: 20px; right: 20px; z-index: 9999; min-width: 300px;",o.innerHTML=`\n                <i class="bi bi-${"success"===t?"check-circle":"danger"===t?"exclamation-triangle":"info-circle"} me-2"></i>\n                ${e}\n                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>\n            `,document.body.appendChild(o),setTimeout((()=>{o.parentNode&&o.parentNode.removeChild(o)}),4e3)}},o={init:function(){this.setupDragAndDrop(),this.setupFileInputs(),this.setupPreviewControls()},setupDragAndDrop:function(){document.querySelectorAll(".photo-upload-form").forEach((e=>{e.addEventListener("dragover",this.handleDragOver.bind(this)),e.addEventListener("dragleave",this.handleDragLeave.bind(this)),e.addEventListener("drop",this.handleDrop.bind(this))}))},setupFileInputs:function(){document.querySelectorAll('input[type="file"][accept*="image"]').forEach((e=>{e.addEventListener("change",this.handleFileSelect.bind(this))}))},setupPreviewControls:function(){const e=document.querySelectorAll(".photo-preview-remove"),t=document.querySelectorAll(".photo-preview-change");e.forEach((e=>{e.addEventListener("click",this.removePreview.bind(this))})),t.forEach((e=>{e.addEventListener("click",this.changePhoto.bind(this))}))},handleDragOver:function(e){e.preventDefault(),e.currentTarget.classList.add("dragover")},handleDragLeave:function(e){e.preventDefault(),e.currentTarget.classList.remove("dragover")},handleDrop:function(e){e.preventDefault(),e.currentTarget.classList.remove("dragover");const t=e.dataTransfer.files;if(t.length>0){const o=e.currentTarget.querySelector('input[type="file"]');o&&(o.files=t,this.handleFileSelect({target:o}))}},handleFileSelect:function(e){const t=e.target.files[0];t&&(this.validatePhoto(t)?(this.showUploadProgress(),this.processPhoto(t,e.target)):e.target.value="")},validatePhoto:function(o){if(!e.allowedImageTypes.includes(o.type))return t.showToast("Tipo de arquivo não permitido. Use JPG, PNG ou WebP.","danger"),!1;const n="."+t.getFileExtension(o.name);if(!e.allowedImageExtensions.includes(n))return t.showToast("Extensão de arquivo não permitida.","danger"),!1;if(o.size>e.maxImageSize){const o=e.maxImageSize/1048576;return t.showToast(`Arquivo muito grande. Máximo: ${o}MB`,"danger"),!1}return!0},processPhoto:function(o,n){const i=new FileReader;i.onload=i=>{const a=new Image;a.onload=()=>{if(a.width>e.maxImageWidth||a.height>e.maxImageHeight)return t.showToast(`Imagem muito grande. Máximo: ${e.maxImageWidth}x${e.maxImageHeight}px`,"danger"),n.value="",void this.hideUploadProgress();this.showPhotoPreview(i.target.result,o,a.width,a.height),this.hideUploadProgress(),t.showToast("Foto carregada com sucesso!","success")},a.onerror=()=>{t.showToast("Erro ao carregar a imagem.","danger"),n.value="",this.hideUploadProgress()},a.src=i.target.result},i.onerror=()=>{t.showToast("Erro ao ler o arquivo.","danger"),n.value="",this.hideUploadProgress()},i.readAsDataURL(o)},showPhotoPreview:function(e,t,o,n){const i=document.getElementById("photoPreview"),a=document.querySelector(".photo-upload-form");if(!i)return;const s=i.querySelector(".photo-preview-image");s&&(s.src=e,s.alt=t.name),this.updatePhotoMetadata(t,o,n),i.style.display="block",a&&(a.style.display="none")},updatePhotoMetadata:function(e,o,n){const i={fileName:document.getElementById("photoFileName"),fileSize:document.getElementById("photoFileSize"),dimensions:document.getElementById("photoDimensions"),fileType:document.getElementById("photoFileType")};i.fileName&&(i.fileName.textContent=e.name),i.fileSize&&(i.fileSize.textContent=t.formatFileSize(e.size)),i.dimensions&&(i.dimensions.textContent=`${o}x${n}px`),i.fileType&&(i.fileType.textContent=e.type)},removePreview:function(e){e.preventDefault();const t=document.getElementById("photoPreview"),o=document.querySelector(".photo-upload-form"),n=document.querySelector('input[type="file"][accept*="image"]');n&&(n.value=""),t&&(t.style.display="none"),o&&(o.style.display="block")},changePhoto:function(e){e.preventDefault();const t=document.querySelector('input[type="file"][accept*="image"]');t&&t.click()},showUploadProgress:function(){const e=document.getElementById("photoUploadProgress");if(e){e.style.display="block";const t=e.querySelector(".photo-progress-fill"),o=e.querySelector(".photo-progress-text");if(t&&o){let e=0;const n=setInterval((()=>{e+=30*Math.random(),e>=100&&(e=100,clearInterval(n)),t.style.width=e+"%",o.textContent=`Processando... ${Math.round(e)}%`}),100)}}},hideUploadProgress:function(){const e=document.getElementById("photoUploadProgress");e&&(e.style.display="none")}};return{init:function(){o.init()},utils:t,upload:o}}(),document.addEventListener("DOMContentLoaded",(function(){Photo.init()}));